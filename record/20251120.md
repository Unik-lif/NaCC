## 实验记录
遇到了一些编译上的问题，正在尝试解决
```C 
// nacc.h
#ifndef _ASM_RISCV_NACC_H
#define _ASM_RISCV_NACC_H

#include <linux/types.h>
#include <asm/sbi.h>

#define NACC_RECLAIM_LIST_SIZE 511

struct nacc_reclaim_list {
	unsigned long pfns[NACC_RECLAIM_LIST_SIZE];
	int count;
};

void add_to_reclaim_list(unsigned long pfn);
void flush_reclaim_list(void);

#endif /* _ASM_RISCV_NACC_H */


// nacc.c
#include <linux/kernel.h>
#include <linux/percpu.h>
#include <asm/nacc.h>

static DEFINE_PER_CPU(struct nacc_reclaim_list, nacc_reclaim_list);

void add_to_reclaim_list(unsigned long pfn)
{
	struct nacc_reclaim_list *reclaim_list = &get_cpu_var(nacc_reclaim_list);
	reclaim_list->pfns[reclaim_list->count++] = pfn;
    // when it meets the max size, flush it.
	if (reclaim_list->count == NACC_RECLAIM_LIST_SIZE) {
		flush_reclaim_list();
	}
	put_cpu_var(reclaim_list);
}

void flush_reclaim_list(void)
{
    // After the full transfer function, flush_reclaim_list function should be called.
	struct nacc_reclaim_list *reclaim_list = &get_cpu_var(nacc_reclaim_list);
	if (reclaim_list->count > 0) {
		sbi_ecall(SBI_EXT_NACC, SBI_EXT_NACC_RECLAIM_PTP,
				  (unsigned long)reclaim_list->pfns, reclaim_list->count,
				  0, 0, 0, 0);
		reclaim_list->count = 0;
	}
	put_cpu_var(reclaim_list);
}

```
可能害的看一下这是什么问题
```C
/home/link/Desktop/NaCC/riscv-tools/bin/riscv64-unknown-linux-gnu-ld: mm/memory.o: in function `free_p4d_range':
/home/link/Desktop/NaCC/linux/mm/memory.c:317:(.text+0x2b7c): undefined reference to `add_to_reclaim_list'
/home/link/Desktop/NaCC/riscv-tools/bin/riscv64-unknown-linux-gnu-ld: /home/link/Desktop/NaCC/linux/mm/memory.c:314:(.text+0x2c8c): undefined reference to `add_to_reclaim_list'
/home/link/Desktop/NaCC/riscv-tools/bin/riscv64-unknown-linux-gnu-ld: mm/mmap.o: in function `exit_mmap':
/home/link/Desktop/NaCC/linux/mm/mmap.c:1920:(.text+0x1074): undefined reference to `flush_reclaim_list'
make[4]: *** [/home/link/Desktop/NaCC/linux/scripts/Makefile.vmlinux:34: vmlinux] Error 1
make[3]: *** [/home/link/Desktop/NaCC/linux/Makefile:1166: vmlinux] Error 2
make[2]: *** [/home/link/Desktop/NaCC/linux/Makefile:224: __sub-make] Error 2
make[2]: Leaving directory '/home/link/Desktop/NaCC/riscv-linux'
make[1]: *** [Makefile:224: __sub-make] Error 2
make[1]: Leaving directory '/home/link/Desktop/NaCC/linux'
make: *** [Makefile:124: linux] Error 2
link@public-4090server:~/Desktop/NaCC$
```

把修改部分落实到了opensbi，将之间分配出来的页表页进行回收，仍然在调试，还有一些零碎的问题，正在调整